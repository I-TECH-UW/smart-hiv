@prefix fhir: <http://hl7.org/fhir/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# - resource -------------------------------------------------------------------

<http://smart.who.int/hiv/Library/WHOCommon> a fhir:Library ;
  fhir:nodeRole fhir:treeRoot ;
  fhir:id [ fhir:v "WHOCommon"] ; # 
  fhir:meta [
     fhir:profile ( [
       fhir:v "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-shareablelibrary"^^xsd:anyURI ;
       fhir:link <http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-shareablelibrary>
     ] [
       fhir:v "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-publishablelibrary"^^xsd:anyURI ;
       fhir:link <http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-publishablelibrary>
     ] [
       fhir:v "http://hl7.org/fhir/uv/cql/StructureDefinition/cql-library"^^xsd:anyURI ;
       fhir:link <http://hl7.org/fhir/uv/cql/StructureDefinition/cql-library>
     ] [
       fhir:v "http://hl7.org/fhir/uv/cql/StructureDefinition/cql-module"^^xsd:anyURI ;
       fhir:link <http://hl7.org/fhir/uv/cql/StructureDefinition/cql-module>
     ] )
  ] ; # 
  fhir:text [
     fhir:status [ fhir:v "extensions" ] ;
     fhir:div "<div xmlns=\"http://www.w3.org/1999/xhtml\">\n<div>\n    <table class=\"grid dict\">\n        \n        \n        <tr>\n            <th scope=\"row\"><b>Title: </b></th>\n            <td style=\"padding-left: 4px;\">WHOCommon</td>\n        </tr>\n        \n\n        \n        \n        <tr>\n            <th scope=\"row\"><b>Id: </b></th>\n            <td style=\"padding-left: 4px;\">WHOCommon</td>\n        </tr>\n        \n\n        \n        \n        <tr>\n            <th scope=\"row\"><b>Version: </b></th>\n            <td style=\"padding-left: 4px;\">0.4.1</td>\n        </tr>\n        \n\n        \n        <tr>\n            <th scope=\"row\"><b>Url: </b></th>\n            <td style=\"padding-left: 4px;\"><a href=\"Library-WHOCommon.html\">WHOCommon</a></td>\n        </tr>\n        \n\n        \n\n        \n\n        \n        <tr>\n            <th scope=\"row\"><b>Status: </b></th>\n            <td style=\"padding-left: 4px;\">draft</td>\n        </tr>\n        \n\n        \n        <tr>\n            <th scope=\"row\"><b>Experimental: </b></th>\n            <td style=\"padding-left: 4px;\">true</td>\n        </tr>\n        \n\n        \n        <tr>\n            <th scope=\"row\"><b>Type: </b></th>\n            <td style=\"padding-left: 4px;\">\n                \n                    \n                        \n                        <p style=\"margin-bottom: 5px;\">\n                            <b>system: </b> <span><a href=\"http://terminology.hl7.org/6.0.2/CodeSystem-library-type.html\">http://terminology.hl7.org/CodeSystem/library-type</a></span>\n                        </p>\n                        \n                        \n                        <p style=\"margin-bottom: 5px;\">\n                            <b>code: </b> <span>logic-library</span>\n                        </p>\n                        \n                        \n                    \n                \n                \n            </td>\n        </tr>\n        \n\n        \n\n        \n        <tr>\n            <th scope=\"row\"><b>Date: </b></th>\n            <td style=\"padding-left: 4px;\">2025-01-31 23:17:43+0000</td>\n        </tr>\n        \n\n        \n        <tr>\n            <th scope=\"row\"><b>Publisher: </b></th>\n            <td style=\"padding-left: 4px;\">WHO</td>\n        </tr>\n        \n\n        \n        <tr>\n            <th scope=\"row\"><b>Description: </b></th>\n            <td style=\"padding-left: 4px;\"><div><p>Description not yet available for WHOCommon.</p>\n</div></td>\n        </tr>\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n\n        \n        \n        <tr>\n          <td colspan=\"2\">\n            <table>\n              <tr><th><a id=\"cql-content\"><b>Content: </b></a> text/cql</th></tr>\n              <tr><td><pre><code class=\"language-cql\">library WHOCommon\r\n\r\nusing FHIR version '4.0.1'\r\n\r\ninclude FHIRHelpers version '4.0.1'\r\n\r\ncodesystem &quot;ConditionClinicalStatusCodes&quot;: 'http://terminology.hl7.org/CodeSystem/condition-clinical'\r\n\r\n// Condition Clinical Status Codes - Consider value sets for these\r\ncode &quot;active&quot;: 'active' from &quot;ConditionClinicalStatusCodes&quot;\r\ncode &quot;recurrence&quot;: 'recurrence' from &quot;ConditionClinicalStatusCodes&quot;\r\ncode &quot;relapse&quot;: 'relapse' from &quot;ConditionClinicalStatusCodes&quot;\r\ncode &quot;inactive&quot;: 'inactive' from &quot;ConditionClinicalStatusCodes&quot;\r\ncode &quot;remission&quot;: 'remission' from &quot;ConditionClinicalStatusCodes&quot;\r\ncode &quot;resolved&quot;: 'resolved' from &quot;ConditionClinicalStatusCodes&quot;\r\n\r\ncontext Patient\r\n\r\ndefine fluent function official(identifiers List&lt;Identifier&gt;):\r\n  singleton from (identifiers I where I.use = 'official')\r\n\r\ndefine fluent function official(addresses List&lt;Address&gt;):\r\n  singleton from (addresses A where A.use = 'official')\r\n\r\ndefine fluent function official(names List&lt;HumanName&gt;):\r\n  singleton from (names N where N.use = 'official')\r\n\r\ndefine fluent function mobile(contactPoints List&lt;ContactPoint&gt;):\r\n  singleton from (contactPoints P where P.use = 'mobile')\r\n\r\ndefine fluent function only(allergies List&lt;AllergyIntolerance&gt;):\r\n  singleton from allergies\r\n\r\ndefine fluent function only(appointments List&lt;Appointment&gt;):\r\n  singleton from appointments\r\n\r\ndefine fluent function only(careplans List&lt;CarePlan&gt;):\r\n  singleton from careplans\r\n\r\ndefine fluent function only(conditions List&lt;Condition&gt;):\r\n  singleton from conditions\r\n\r\ndefine fluent function only(encounters List&lt;Encounter&gt;):\r\n  singleton from encounters\r\n\r\ndefine fluent function only(immunizations List&lt;Immunization&gt;):\r\n  singleton from immunizations\r\n\r\ndefine fluent function only(locations List&lt;Location&gt;):\r\n  singleton from locations\r\n\r\ndefine fluent function only(medicationrequests List&lt;MedicationRequest&gt;):\r\n  singleton from medicationrequests\r\n\r\ndefine fluent function only(observations List&lt;Observation&gt;):\r\n  singleton from observations\r\n\r\ndefine fluent function only(procedures List&lt;Procedure&gt;):\r\n  singleton from procedures\r\n\r\ndefine fluent function only(serviceRequests List&lt;ServiceRequest&gt;):\r\n  singleton from serviceRequests\r\n\r\ndefine fluent function only(dosages List&lt;Dosage&gt;):\r\n  singleton from dosages\r\n\r\ndefine fluent function only(doses List&lt;FHIR.Dosage.DoseAndRate&gt;):\r\n  singleton from doses\r\n\r\ndefine fluent function earliest(observations List&lt;Observation&gt;):\r\n  First(\r\n    observations O\r\n      sort by issued\r\n  )\r\n\r\ndefine fluent function latest(observations List&lt;Observation&gt;):\r\n  Last(\r\n    observations O\r\n      sort by issued\r\n  )\r\n\r\ndefine fluent function mostRecent(observations List&lt;Observation&gt;):\r\n  Last(\r\n    observations O\r\n      sort by issued\r\n  )\r\n\r\ndefine fluent function mostRecent(procedures List&lt;Procedure&gt;):\r\n  Last(\r\n    procedures P\r\n      sort by start of performed.toInterval()\r\n  )\r\n\r\ndefine fluent function mostRecent(immunizations List&lt;Immunization&gt;):\r\n  Last(\r\n    immunizations I\r\n      sort by start of occurrence.toInterval()\r\n  )\r\n\r\ndefine fluent function mostRecent(medicationRequests List&lt;MedicationRequest&gt;):\r\n  Last(\r\n    medicationRequests MR\r\n      sort by authoredOn\r\n  )\r\n\r\ndefine fluent function lowest(observations List&lt;Observation&gt;):\r\n  First(\r\n    observations O\r\n      sort by FHIRHelpers.ToQuantity(value as FHIR.Quantity)\r\n  )\r\n\r\ndefine fluent function highest(observations List&lt;Observation&gt;):\r\n  Last(\r\n    observations O\r\n      sort by FHIRHelpers.ToQuantity(value as FHIR.Quantity)\r\n  )\r\n\r\ndefine function EarliestOf(dates List&lt;Date&gt;):\r\n  Min(dates)\r\n\r\ndefine function LatestOf(dates List&lt;Date&gt;):\r\n  Max(dates)\r\n\r\n/*\r\nFrom FHIRCommon 4.1.0:\r\n*/\r\n\r\n/*\r\n@description: Normalizes a value that is a choice of timing-valued types to an equivalent interval\r\n@comment: Normalizes a choice type of FHIR.dateTime, FHIR.Period, FHIR.Timing, FHIR.instance, FHIR.string, FHIR.Age, or FHIR.Range types\r\nto an equivalent interval. This selection of choice types is a superset of the majority of choice types that are used as possible\r\nrepresentations for timing-valued elements in FHIR, allowing this function to be used across any resource.\r\n\r\nThe input can be provided as a dateTime, Period, Timing, instant, string, Age, or Range.\r\nThe intent of this function is to provide a clear and concise mechanism to treat single\r\nelements that have multiple possible representations as intervals so that logic doesn't have to account\r\nfor the variability. More complex calculations (such as medication request period or dispense period\r\ncalculation) need specific guidance and consideration. That guidance may make use of this function, but\r\nthe focus of this function is on single element calculations where the semantics are unambiguous.\r\nIf the input is a dateTime, the result a DateTime Interval beginning and ending on that dateTime.\r\nIf the input is a Period, the result is a DateTime Interval.\r\nIf the input is a Timing, an error is raised indicating a single interval cannot be computed from a Timing.\r\nIf the input is an instant, the result is a DateTime Interval beginning and ending on that instant.\r\nIf the input is a string, an error is raised indicating a single interval cannot be computed from a string.\r\nIf the input is an Age, the result is a DateTime Interval beginning when the patient was the given Age,\r\nand ending immediately prior to when the patient was the given Age plus one year.\r\nIf the input is a Range, the result is a DateTime Interval beginning when the patient was the Age given\r\nby the low end of the Range, and ending immediately prior to when the patient was the Age given by the\r\nhigh end of the Range plus one year.\r\n\r\nNOTE: Due to the\r\ncomplexity of determining a single interval from a Timing or String type, this function will throw a run-time exception if it is used\r\nwith a Timing or String.\r\n*/\r\ndefine fluent function toInterval(choice Choice&lt;FHIR.dateTime, FHIR.Period, FHIR.Timing, FHIR.instant, FHIR.string, FHIR.Age, FHIR.Range&gt;):\r\n  case\r\n    when choice is FHIR.dateTime then\r\n      Interval[FHIRHelpers.ToDateTime(choice as FHIR.dateTime), FHIRHelpers.ToDateTime(choice as FHIR.dateTime)]\r\n    when choice is FHIR.Period then\r\n      FHIRHelpers.ToInterval(choice as FHIR.Period)\r\n    when choice is FHIR.instant then\r\n      Interval[FHIRHelpers.ToDateTime(choice as FHIR.instant), FHIRHelpers.ToDateTime(choice as FHIR.instant)]\r\n    when choice is FHIR.Age then\r\n      Interval[FHIRHelpers.ToDate(Patient.birthDate) + FHIRHelpers.ToQuantity(choice as FHIR.Age),\r\n        FHIRHelpers.ToDate(Patient.birthDate) + FHIRHelpers.ToQuantity(choice as FHIR.Age) + 1 year)\r\n    when choice is FHIR.Range then\r\n      Interval[FHIRHelpers.ToDate(Patient.birthDate) + FHIRHelpers.ToQuantity((choice as FHIR.Range).low),\r\n        FHIRHelpers.ToDate(Patient.birthDate) + FHIRHelpers.ToQuantity((choice as FHIR.Range).high) + 1 year)\r\n    when choice is FHIR.Timing then\r\n      Message(null as Interval&lt;DateTime&gt;, true, 'NOT_IMPLEMENTED', 'Error', 'Calculation of an interval from a Timing value is not supported')\r\n    when choice is FHIR.string then\r\n      Message(null as Interval&lt;DateTime&gt;, true, 'NOT_IMPLEMENTED', 'Error', 'Calculation of an interval from a String value is not supported')\r\n    else\r\n      null as Interval&lt;DateTime&gt;\r\n  end\r\n\r\n/*\r\n@description: Returns an interval representing the normalized Abatement of a given Condition resource.\r\n@comment: NOTE: Due to the complexity of determining an interval from a String, this function will throw\r\na run-time exception if used with a Condition instance that has a String as the abatement value.\r\n*/\r\ndefine fluent function abatementInterval(condition Condition):\r\n  if condition.abatement is FHIR.dateTime then\r\n    Interval[FHIRHelpers.ToDateTime(condition.abatement as FHIR.dateTime), FHIRHelpers.ToDateTime(condition.abatement as FHIR.dateTime)]\r\n  else if condition.abatement is FHIR.Period then\r\n    FHIRHelpers.ToInterval(condition.abatement as FHIR.Period)\r\n  else if condition.abatement is FHIR.string then\r\n    Message(null as Interval&lt;DateTime&gt;, true, 'NOT_IMPLEMENTED', 'Error', 'Calculation of an interval from a String value is not supported')\r\n  else if condition.abatement is FHIR.Age then\r\n    Interval[FHIRHelpers.ToDate(Patient.birthDate) + FHIRHelpers.ToQuantity(condition.abatement as FHIR.Age),\r\n      FHIRHelpers.ToDate(Patient.birthDate) + FHIRHelpers.ToQuantity(condition.abatement as FHIR.Age) + 1 year)\r\n  else if condition.abatement is FHIR.Range then\r\n    Interval[FHIRHelpers.ToDate(Patient.birthDate) + FHIRHelpers.ToQuantity((condition.abatement as FHIR.Range).low),\r\n      FHIRHelpers.ToDate(Patient.birthDate) + FHIRHelpers.ToQuantity((condition.abatement as FHIR.Range).high) + 1 year)\r\n  else if condition.abatement is FHIR.boolean then\r\n    Interval[end of condition.onset.toInterval(), condition.recordedDate)\r\n  else \r\n    null\r\n\r\n/*\r\n@description: Returns an interval representing the normalized prevalence period of a given Condition resource.\r\n@comment: Uses the toInterval and toAbatementInterval functions to determine the widest potential interval from\r\nonset to abatement as specified in the given Condition.\r\n*/\r\ndefine fluent function prevalenceInterval(condition Condition):\r\nif condition.clinicalStatus ~ &quot;active&quot;\r\n  or condition.clinicalStatus ~ &quot;recurrence&quot;\r\n  or condition.clinicalStatus ~ &quot;relapse&quot; then\r\n  Interval[start of condition.onset.toInterval(), end of condition.abatementInterval()]\r\nelse\r\n  (end of condition.abatementInterval()) abatementDate\r\n    return \r\n	  if abatementDate is null then\r\n        Interval[start of condition.onset.toInterval(), abatementDate)\r\n      else\r\n        Interval[start of condition.onset.toInterval(), abatementDate]\r\n\r\n/*\r\n@description: Returns true if the given reference is to the given resource\r\n@comment: Returns true if the `id` element of the given resource exactly equals the tail of the given reference.\r\nNOTE: This function assumes resources from the same source server.\r\n*/\r\ndefine fluent function references(reference FHIR.Reference, resource FHIR.Resource):\r\n  resource.id = Last(Split(reference.reference, '/'))  \r\n\r\n/*\r\n@description: Returns true if the given reference is to the given resourceId\r\n@comment: Returns true if the `resourceId` parameter exactly equals the tail of the given reference.\r\nNOTE: This function assumes resources from the same source server.\r\n*/\r\ndefine fluent function references(reference FHIR.Reference, resourceId String):\r\n  resourceId = Last(Split(reference.reference, '/'))\r\n\r\n/*\r\n@description: Returns true if any of the given references are to the given resource\r\n@comment: Returns true if the `id` element of the given resource exactly equals the tail of any of the given references.\r\nNOTE: This function assumes resources from the same source server.\r\n*/\r\ndefine fluent function references(references List&lt;FHIR.Reference&gt;, resource FHIR.Resource):\r\n  exists (references R where R.references(resource))\r\n  \r\n/*\r\n@description: Returns true if any of the given references are to the given resourceId\r\n@comment: Returns true if the `resourceId` parameter exactly equals the tail of any of the given references.\r\nNOTE: This function assumes resources from the same source server.\r\n*/\r\ndefine fluent function references(references List&lt;FHIR.Reference&gt;, resourceId String):\r\n  exists (references R where R.references(resourceId))\r\n</code></pre></td></tr>\n            </table>\n          </td>\n        </tr>\n        \n        \n        \n    </table>\n</div>\n</div>"
  ] ; # 
  fhir:extension ( [
     fhir:url [ fhir:v "http://hl7.org/fhir/StructureDefinition/cqf-knowledgeCapability"^^xsd:anyURI ] ;
     fhir:value [ fhir:v "computable" ]
  ] ) ; # 
  fhir:url [ fhir:v "http://smart.who.int/hiv/Library/WHOCommon"^^xsd:anyURI] ; # 
  fhir:version [ fhir:v "0.4.1"] ; # 
  fhir:name [ fhir:v "WHOCommon"] ; # 
  fhir:title [ fhir:v "WHOCommon"] ; # 
  fhir:status [ fhir:v "draft"] ; # 
  fhir:experimental [ fhir:v "true"^^xsd:boolean] ; # 
  fhir:type [
     fhir:coding ( [
       fhir:system [ fhir:v "http://terminology.hl7.org/CodeSystem/library-type"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "logic-library" ]
     ] )
  ] ; # 
  fhir:date [ fhir:v "2025-01-31T23:17:43+00:00"^^xsd:dateTime] ; # 
  fhir:publisher [ fhir:v "WHO"] ; # 
  fhir:contact ( [
     fhir:name [ fhir:v "WHO" ] ;
     fhir:telecom ( [
       fhir:system [ fhir:v "url" ] ;
       fhir:value [ fhir:v "http://who.int" ]
     ] )
  ] ) ; # 
  fhir:description [ fhir:v "Description not yet available for WHOCommon."] ; # 
  fhir:content ( [
     fhir:contentType [ fhir:v "text/cql" ] ;
     fhir:data [ fhir:v "bGlicmFyeSBXSE9Db21tb24NCg0KdXNpbmcgRkhJUiB2ZXJzaW9uICc0LjAuMScNCg0KaW5jbHVkZSBGSElSSGVscGVycyB2ZXJzaW9uICc0LjAuMScNCg0KY29kZXN5c3RlbSAiQ29uZGl0aW9uQ2xpbmljYWxTdGF0dXNDb2RlcyI6ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL2NvbmRpdGlvbi1jbGluaWNhbCcNCg0KLy8gQ29uZGl0aW9uIENsaW5pY2FsIFN0YXR1cyBDb2RlcyAtIENvbnNpZGVyIHZhbHVlIHNldHMgZm9yIHRoZXNlDQpjb2RlICJhY3RpdmUiOiAnYWN0aXZlJyBmcm9tICJDb25kaXRpb25DbGluaWNhbFN0YXR1c0NvZGVzIg0KY29kZSAicmVjdXJyZW5jZSI6ICdyZWN1cnJlbmNlJyBmcm9tICJDb25kaXRpb25DbGluaWNhbFN0YXR1c0NvZGVzIg0KY29kZSAicmVsYXBzZSI6ICdyZWxhcHNlJyBmcm9tICJDb25kaXRpb25DbGluaWNhbFN0YXR1c0NvZGVzIg0KY29kZSAiaW5hY3RpdmUiOiAnaW5hY3RpdmUnIGZyb20gIkNvbmRpdGlvbkNsaW5pY2FsU3RhdHVzQ29kZXMiDQpjb2RlICJyZW1pc3Npb24iOiAncmVtaXNzaW9uJyBmcm9tICJDb25kaXRpb25DbGluaWNhbFN0YXR1c0NvZGVzIg0KY29kZSAicmVzb2x2ZWQiOiAncmVzb2x2ZWQnIGZyb20gIkNvbmRpdGlvbkNsaW5pY2FsU3RhdHVzQ29kZXMiDQoNCmNvbnRleHQgUGF0aWVudA0KDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIG9mZmljaWFsKGlkZW50aWZpZXJzIExpc3Q8SWRlbnRpZmllcj4pOg0KICBzaW5nbGV0b24gZnJvbSAoaWRlbnRpZmllcnMgSSB3aGVyZSBJLnVzZSA9ICdvZmZpY2lhbCcpDQoNCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gb2ZmaWNpYWwoYWRkcmVzc2VzIExpc3Q8QWRkcmVzcz4pOg0KICBzaW5nbGV0b24gZnJvbSAoYWRkcmVzc2VzIEEgd2hlcmUgQS51c2UgPSAnb2ZmaWNpYWwnKQ0KDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIG9mZmljaWFsKG5hbWVzIExpc3Q8SHVtYW5OYW1lPik6DQogIHNpbmdsZXRvbiBmcm9tIChuYW1lcyBOIHdoZXJlIE4udXNlID0gJ29mZmljaWFsJykNCg0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBtb2JpbGUoY29udGFjdFBvaW50cyBMaXN0PENvbnRhY3RQb2ludD4pOg0KICBzaW5nbGV0b24gZnJvbSAoY29udGFjdFBvaW50cyBQIHdoZXJlIFAudXNlID0gJ21vYmlsZScpDQoNCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gb25seShhbGxlcmdpZXMgTGlzdDxBbGxlcmd5SW50b2xlcmFuY2U+KToNCiAgc2luZ2xldG9uIGZyb20gYWxsZXJnaWVzDQoNCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gb25seShhcHBvaW50bWVudHMgTGlzdDxBcHBvaW50bWVudD4pOg0KICBzaW5nbGV0b24gZnJvbSBhcHBvaW50bWVudHMNCg0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBvbmx5KGNhcmVwbGFucyBMaXN0PENhcmVQbGFuPik6DQogIHNpbmdsZXRvbiBmcm9tIGNhcmVwbGFucw0KDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIG9ubHkoY29uZGl0aW9ucyBMaXN0PENvbmRpdGlvbj4pOg0KICBzaW5nbGV0b24gZnJvbSBjb25kaXRpb25zDQoNCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gb25seShlbmNvdW50ZXJzIExpc3Q8RW5jb3VudGVyPik6DQogIHNpbmdsZXRvbiBmcm9tIGVuY291bnRlcnMNCg0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBvbmx5KGltbXVuaXphdGlvbnMgTGlzdDxJbW11bml6YXRpb24+KToNCiAgc2luZ2xldG9uIGZyb20gaW1tdW5pemF0aW9ucw0KDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIG9ubHkobG9jYXRpb25zIExpc3Q8TG9jYXRpb24+KToNCiAgc2luZ2xldG9uIGZyb20gbG9jYXRpb25zDQoNCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gb25seShtZWRpY2F0aW9ucmVxdWVzdHMgTGlzdDxNZWRpY2F0aW9uUmVxdWVzdD4pOg0KICBzaW5nbGV0b24gZnJvbSBtZWRpY2F0aW9ucmVxdWVzdHMNCg0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBvbmx5KG9ic2VydmF0aW9ucyBMaXN0PE9ic2VydmF0aW9uPik6DQogIHNpbmdsZXRvbiBmcm9tIG9ic2VydmF0aW9ucw0KDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIG9ubHkocHJvY2VkdXJlcyBMaXN0PFByb2NlZHVyZT4pOg0KICBzaW5nbGV0b24gZnJvbSBwcm9jZWR1cmVzDQoNCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gb25seShzZXJ2aWNlUmVxdWVzdHMgTGlzdDxTZXJ2aWNlUmVxdWVzdD4pOg0KICBzaW5nbGV0b24gZnJvbSBzZXJ2aWNlUmVxdWVzdHMNCg0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBvbmx5KGRvc2FnZXMgTGlzdDxEb3NhZ2U+KToNCiAgc2luZ2xldG9uIGZyb20gZG9zYWdlcw0KDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIG9ubHkoZG9zZXMgTGlzdDxGSElSLkRvc2FnZS5Eb3NlQW5kUmF0ZT4pOg0KICBzaW5nbGV0b24gZnJvbSBkb3Nlcw0KDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGVhcmxpZXN0KG9ic2VydmF0aW9ucyBMaXN0PE9ic2VydmF0aW9uPik6DQogIEZpcnN0KA0KICAgIG9ic2VydmF0aW9ucyBPDQogICAgICBzb3J0IGJ5IGlzc3VlZA0KICApDQoNCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gbGF0ZXN0KG9ic2VydmF0aW9ucyBMaXN0PE9ic2VydmF0aW9uPik6DQogIExhc3QoDQogICAgb2JzZXJ2YXRpb25zIE8NCiAgICAgIHNvcnQgYnkgaXNzdWVkDQogICkNCg0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBtb3N0UmVjZW50KG9ic2VydmF0aW9ucyBMaXN0PE9ic2VydmF0aW9uPik6DQogIExhc3QoDQogICAgb2JzZXJ2YXRpb25zIE8NCiAgICAgIHNvcnQgYnkgaXNzdWVkDQogICkNCg0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBtb3N0UmVjZW50KHByb2NlZHVyZXMgTGlzdDxQcm9jZWR1cmU+KToNCiAgTGFzdCgNCiAgICBwcm9jZWR1cmVzIFANCiAgICAgIHNvcnQgYnkgc3RhcnQgb2YgcGVyZm9ybWVkLnRvSW50ZXJ2YWwoKQ0KICApDQoNCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gbW9zdFJlY2VudChpbW11bml6YXRpb25zIExpc3Q8SW1tdW5pemF0aW9uPik6DQogIExhc3QoDQogICAgaW1tdW5pemF0aW9ucyBJDQogICAgICBzb3J0IGJ5IHN0YXJ0IG9mIG9jY3VycmVuY2UudG9JbnRlcnZhbCgpDQogICkNCg0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBtb3N0UmVjZW50KG1lZGljYXRpb25SZXF1ZXN0cyBMaXN0PE1lZGljYXRpb25SZXF1ZXN0Pik6DQogIExhc3QoDQogICAgbWVkaWNhdGlvblJlcXVlc3RzIE1SDQogICAgICBzb3J0IGJ5IGF1dGhvcmVkT24NCiAgKQ0KDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGxvd2VzdChvYnNlcnZhdGlvbnMgTGlzdDxPYnNlcnZhdGlvbj4pOg0KICBGaXJzdCgNCiAgICBvYnNlcnZhdGlvbnMgTw0KICAgICAgc29ydCBieSBGSElSSGVscGVycy5Ub1F1YW50aXR5KHZhbHVlIGFzIEZISVIuUXVhbnRpdHkpDQogICkNCg0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBoaWdoZXN0KG9ic2VydmF0aW9ucyBMaXN0PE9ic2VydmF0aW9uPik6DQogIExhc3QoDQogICAgb2JzZXJ2YXRpb25zIE8NCiAgICAgIHNvcnQgYnkgRkhJUkhlbHBlcnMuVG9RdWFudGl0eSh2YWx1ZSBhcyBGSElSLlF1YW50aXR5KQ0KICApDQoNCmRlZmluZSBmdW5jdGlvbiBFYXJsaWVzdE9mKGRhdGVzIExpc3Q8RGF0ZT4pOg0KICBNaW4oZGF0ZXMpDQoNCmRlZmluZSBmdW5jdGlvbiBMYXRlc3RPZihkYXRlcyBMaXN0PERhdGU+KToNCiAgTWF4KGRhdGVzKQ0KDQovKg0KRnJvbSBGSElSQ29tbW9uIDQuMS4wOg0KKi8NCg0KLyoNCkBkZXNjcmlwdGlvbjogTm9ybWFsaXplcyBhIHZhbHVlIHRoYXQgaXMgYSBjaG9pY2Ugb2YgdGltaW5nLXZhbHVlZCB0eXBlcyB0byBhbiBlcXVpdmFsZW50IGludGVydmFsDQpAY29tbWVudDogTm9ybWFsaXplcyBhIGNob2ljZSB0eXBlIG9mIEZISVIuZGF0ZVRpbWUsIEZISVIuUGVyaW9kLCBGSElSLlRpbWluZywgRkhJUi5pbnN0YW5jZSwgRkhJUi5zdHJpbmcsIEZISVIuQWdlLCBvciBGSElSLlJhbmdlIHR5cGVzDQp0byBhbiBlcXVpdmFsZW50IGludGVydmFsLiBUaGlzIHNlbGVjdGlvbiBvZiBjaG9pY2UgdHlwZXMgaXMgYSBzdXBlcnNldCBvZiB0aGUgbWFqb3JpdHkgb2YgY2hvaWNlIHR5cGVzIHRoYXQgYXJlIHVzZWQgYXMgcG9zc2libGUNCnJlcHJlc2VudGF0aW9ucyBmb3IgdGltaW5nLXZhbHVlZCBlbGVtZW50cyBpbiBGSElSLCBhbGxvd2luZyB0aGlzIGZ1bmN0aW9uIHRvIGJlIHVzZWQgYWNyb3NzIGFueSByZXNvdXJjZS4NCg0KVGhlIGlucHV0IGNhbiBiZSBwcm92aWRlZCBhcyBhIGRhdGVUaW1lLCBQZXJpb2QsIFRpbWluZywgaW5zdGFudCwgc3RyaW5nLCBBZ2UsIG9yIFJhbmdlLg0KVGhlIGludGVudCBvZiB0aGlzIGZ1bmN0aW9uIGlzIHRvIHByb3ZpZGUgYSBjbGVhciBhbmQgY29uY2lzZSBtZWNoYW5pc20gdG8gdHJlYXQgc2luZ2xlDQplbGVtZW50cyB0aGF0IGhhdmUgbXVsdGlwbGUgcG9zc2libGUgcmVwcmVzZW50YXRpb25zIGFzIGludGVydmFscyBzbyB0aGF0IGxvZ2ljIGRvZXNuJ3QgaGF2ZSB0byBhY2NvdW50DQpmb3IgdGhlIHZhcmlhYmlsaXR5LiBNb3JlIGNvbXBsZXggY2FsY3VsYXRpb25zIChzdWNoIGFzIG1lZGljYXRpb24gcmVxdWVzdCBwZXJpb2Qgb3IgZGlzcGVuc2UgcGVyaW9kDQpjYWxjdWxhdGlvbikgbmVlZCBzcGVjaWZpYyBndWlkYW5jZSBhbmQgY29uc2lkZXJhdGlvbi4gVGhhdCBndWlkYW5jZSBtYXkgbWFrZSB1c2Ugb2YgdGhpcyBmdW5jdGlvbiwgYnV0DQp0aGUgZm9jdXMgb2YgdGhpcyBmdW5jdGlvbiBpcyBvbiBzaW5nbGUgZWxlbWVudCBjYWxjdWxhdGlvbnMgd2hlcmUgdGhlIHNlbWFudGljcyBhcmUgdW5hbWJpZ3VvdXMuDQpJZiB0aGUgaW5wdXQgaXMgYSBkYXRlVGltZSwgdGhlIHJlc3VsdCBhIERhdGVUaW1lIEludGVydmFsIGJlZ2lubmluZyBhbmQgZW5kaW5nIG9uIHRoYXQgZGF0ZVRpbWUuDQpJZiB0aGUgaW5wdXQgaXMgYSBQZXJpb2QsIHRoZSByZXN1bHQgaXMgYSBEYXRlVGltZSBJbnRlcnZhbC4NCklmIHRoZSBpbnB1dCBpcyBhIFRpbWluZywgYW4gZXJyb3IgaXMgcmFpc2VkIGluZGljYXRpbmcgYSBzaW5nbGUgaW50ZXJ2YWwgY2Fubm90IGJlIGNvbXB1dGVkIGZyb20gYSBUaW1pbmcuDQpJZiB0aGUgaW5wdXQgaXMgYW4gaW5zdGFudCwgdGhlIHJlc3VsdCBpcyBhIERhdGVUaW1lIEludGVydmFsIGJlZ2lubmluZyBhbmQgZW5kaW5nIG9uIHRoYXQgaW5zdGFudC4NCklmIHRoZSBpbnB1dCBpcyBhIHN0cmluZywgYW4gZXJyb3IgaXMgcmFpc2VkIGluZGljYXRpbmcgYSBzaW5nbGUgaW50ZXJ2YWwgY2Fubm90IGJlIGNvbXB1dGVkIGZyb20gYSBzdHJpbmcuDQpJZiB0aGUgaW5wdXQgaXMgYW4gQWdlLCB0aGUgcmVzdWx0IGlzIGEgRGF0ZVRpbWUgSW50ZXJ2YWwgYmVnaW5uaW5nIHdoZW4gdGhlIHBhdGllbnQgd2FzIHRoZSBnaXZlbiBBZ2UsDQphbmQgZW5kaW5nIGltbWVkaWF0ZWx5IHByaW9yIHRvIHdoZW4gdGhlIHBhdGllbnQgd2FzIHRoZSBnaXZlbiBBZ2UgcGx1cyBvbmUgeWVhci4NCklmIHRoZSBpbnB1dCBpcyBhIFJhbmdlLCB0aGUgcmVzdWx0IGlzIGEgRGF0ZVRpbWUgSW50ZXJ2YWwgYmVnaW5uaW5nIHdoZW4gdGhlIHBhdGllbnQgd2FzIHRoZSBBZ2UgZ2l2ZW4NCmJ5IHRoZSBsb3cgZW5kIG9mIHRoZSBSYW5nZSwgYW5kIGVuZGluZyBpbW1lZGlhdGVseSBwcmlvciB0byB3aGVuIHRoZSBwYXRpZW50IHdhcyB0aGUgQWdlIGdpdmVuIGJ5IHRoZQ0KaGlnaCBlbmQgb2YgdGhlIFJhbmdlIHBsdXMgb25lIHllYXIuDQoNCk5PVEU6IER1ZSB0byB0aGUNCmNvbXBsZXhpdHkgb2YgZGV0ZXJtaW5pbmcgYSBzaW5nbGUgaW50ZXJ2YWwgZnJvbSBhIFRpbWluZyBvciBTdHJpbmcgdHlwZSwgdGhpcyBmdW5jdGlvbiB3aWxsIHRocm93IGEgcnVuLXRpbWUgZXhjZXB0aW9uIGlmIGl0IGlzIHVzZWQNCndpdGggYSBUaW1pbmcgb3IgU3RyaW5nLg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gdG9JbnRlcnZhbChjaG9pY2UgQ2hvaWNlPEZISVIuZGF0ZVRpbWUsIEZISVIuUGVyaW9kLCBGSElSLlRpbWluZywgRkhJUi5pbnN0YW50LCBGSElSLnN0cmluZywgRkhJUi5BZ2UsIEZISVIuUmFuZ2U+KToNCiAgY2FzZQ0KICAgIHdoZW4gY2hvaWNlIGlzIEZISVIuZGF0ZVRpbWUgdGhlbg0KICAgICAgSW50ZXJ2YWxbRkhJUkhlbHBlcnMuVG9EYXRlVGltZShjaG9pY2UgYXMgRkhJUi5kYXRlVGltZSksIEZISVJIZWxwZXJzLlRvRGF0ZVRpbWUoY2hvaWNlIGFzIEZISVIuZGF0ZVRpbWUpXQ0KICAgIHdoZW4gY2hvaWNlIGlzIEZISVIuUGVyaW9kIHRoZW4NCiAgICAgIEZISVJIZWxwZXJzLlRvSW50ZXJ2YWwoY2hvaWNlIGFzIEZISVIuUGVyaW9kKQ0KICAgIHdoZW4gY2hvaWNlIGlzIEZISVIuaW5zdGFudCB0aGVuDQogICAgICBJbnRlcnZhbFtGSElSSGVscGVycy5Ub0RhdGVUaW1lKGNob2ljZSBhcyBGSElSLmluc3RhbnQpLCBGSElSSGVscGVycy5Ub0RhdGVUaW1lKGNob2ljZSBhcyBGSElSLmluc3RhbnQpXQ0KICAgIHdoZW4gY2hvaWNlIGlzIEZISVIuQWdlIHRoZW4NCiAgICAgIEludGVydmFsW0ZISVJIZWxwZXJzLlRvRGF0ZShQYXRpZW50LmJpcnRoRGF0ZSkgKyBGSElSSGVscGVycy5Ub1F1YW50aXR5KGNob2ljZSBhcyBGSElSLkFnZSksDQogICAgICAgIEZISVJIZWxwZXJzLlRvRGF0ZShQYXRpZW50LmJpcnRoRGF0ZSkgKyBGSElSSGVscGVycy5Ub1F1YW50aXR5KGNob2ljZSBhcyBGSElSLkFnZSkgKyAxIHllYXIpDQogICAgd2hlbiBjaG9pY2UgaXMgRkhJUi5SYW5nZSB0aGVuDQogICAgICBJbnRlcnZhbFtGSElSSGVscGVycy5Ub0RhdGUoUGF0aWVudC5iaXJ0aERhdGUpICsgRkhJUkhlbHBlcnMuVG9RdWFudGl0eSgoY2hvaWNlIGFzIEZISVIuUmFuZ2UpLmxvdyksDQogICAgICAgIEZISVJIZWxwZXJzLlRvRGF0ZShQYXRpZW50LmJpcnRoRGF0ZSkgKyBGSElSSGVscGVycy5Ub1F1YW50aXR5KChjaG9pY2UgYXMgRkhJUi5SYW5nZSkuaGlnaCkgKyAxIHllYXIpDQogICAgd2hlbiBjaG9pY2UgaXMgRkhJUi5UaW1pbmcgdGhlbg0KICAgICAgTWVzc2FnZShudWxsIGFzIEludGVydmFsPERhdGVUaW1lPiwgdHJ1ZSwgJ05PVF9JTVBMRU1FTlRFRCcsICdFcnJvcicsICdDYWxjdWxhdGlvbiBvZiBhbiBpbnRlcnZhbCBmcm9tIGEgVGltaW5nIHZhbHVlIGlzIG5vdCBzdXBwb3J0ZWQnKQ0KICAgIHdoZW4gY2hvaWNlIGlzIEZISVIuc3RyaW5nIHRoZW4NCiAgICAgIE1lc3NhZ2UobnVsbCBhcyBJbnRlcnZhbDxEYXRlVGltZT4sIHRydWUsICdOT1RfSU1QTEVNRU5URUQnLCAnRXJyb3InLCAnQ2FsY3VsYXRpb24gb2YgYW4gaW50ZXJ2YWwgZnJvbSBhIFN0cmluZyB2YWx1ZSBpcyBub3Qgc3VwcG9ydGVkJykNCiAgICBlbHNlDQogICAgICBudWxsIGFzIEludGVydmFsPERhdGVUaW1lPg0KICBlbmQNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyBhbiBpbnRlcnZhbCByZXByZXNlbnRpbmcgdGhlIG5vcm1hbGl6ZWQgQWJhdGVtZW50IG9mIGEgZ2l2ZW4gQ29uZGl0aW9uIHJlc291cmNlLg0KQGNvbW1lbnQ6IE5PVEU6IER1ZSB0byB0aGUgY29tcGxleGl0eSBvZiBkZXRlcm1pbmluZyBhbiBpbnRlcnZhbCBmcm9tIGEgU3RyaW5nLCB0aGlzIGZ1bmN0aW9uIHdpbGwgdGhyb3cNCmEgcnVuLXRpbWUgZXhjZXB0aW9uIGlmIHVzZWQgd2l0aCBhIENvbmRpdGlvbiBpbnN0YW5jZSB0aGF0IGhhcyBhIFN0cmluZyBhcyB0aGUgYWJhdGVtZW50IHZhbHVlLg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gYWJhdGVtZW50SW50ZXJ2YWwoY29uZGl0aW9uIENvbmRpdGlvbik6DQogIGlmIGNvbmRpdGlvbi5hYmF0ZW1lbnQgaXMgRkhJUi5kYXRlVGltZSB0aGVuDQogICAgSW50ZXJ2YWxbRkhJUkhlbHBlcnMuVG9EYXRlVGltZShjb25kaXRpb24uYWJhdGVtZW50IGFzIEZISVIuZGF0ZVRpbWUpLCBGSElSSGVscGVycy5Ub0RhdGVUaW1lKGNvbmRpdGlvbi5hYmF0ZW1lbnQgYXMgRkhJUi5kYXRlVGltZSldDQogIGVsc2UgaWYgY29uZGl0aW9uLmFiYXRlbWVudCBpcyBGSElSLlBlcmlvZCB0aGVuDQogICAgRkhJUkhlbHBlcnMuVG9JbnRlcnZhbChjb25kaXRpb24uYWJhdGVtZW50IGFzIEZISVIuUGVyaW9kKQ0KICBlbHNlIGlmIGNvbmRpdGlvbi5hYmF0ZW1lbnQgaXMgRkhJUi5zdHJpbmcgdGhlbg0KICAgIE1lc3NhZ2UobnVsbCBhcyBJbnRlcnZhbDxEYXRlVGltZT4sIHRydWUsICdOT1RfSU1QTEVNRU5URUQnLCAnRXJyb3InLCAnQ2FsY3VsYXRpb24gb2YgYW4gaW50ZXJ2YWwgZnJvbSBhIFN0cmluZyB2YWx1ZSBpcyBub3Qgc3VwcG9ydGVkJykNCiAgZWxzZSBpZiBjb25kaXRpb24uYWJhdGVtZW50IGlzIEZISVIuQWdlIHRoZW4NCiAgICBJbnRlcnZhbFtGSElSSGVscGVycy5Ub0RhdGUoUGF0aWVudC5iaXJ0aERhdGUpICsgRkhJUkhlbHBlcnMuVG9RdWFudGl0eShjb25kaXRpb24uYWJhdGVtZW50IGFzIEZISVIuQWdlKSwNCiAgICAgIEZISVJIZWxwZXJzLlRvRGF0ZShQYXRpZW50LmJpcnRoRGF0ZSkgKyBGSElSSGVscGVycy5Ub1F1YW50aXR5KGNvbmRpdGlvbi5hYmF0ZW1lbnQgYXMgRkhJUi5BZ2UpICsgMSB5ZWFyKQ0KICBlbHNlIGlmIGNvbmRpdGlvbi5hYmF0ZW1lbnQgaXMgRkhJUi5SYW5nZSB0aGVuDQogICAgSW50ZXJ2YWxbRkhJUkhlbHBlcnMuVG9EYXRlKFBhdGllbnQuYmlydGhEYXRlKSArIEZISVJIZWxwZXJzLlRvUXVhbnRpdHkoKGNvbmRpdGlvbi5hYmF0ZW1lbnQgYXMgRkhJUi5SYW5nZSkubG93KSwNCiAgICAgIEZISVJIZWxwZXJzLlRvRGF0ZShQYXRpZW50LmJpcnRoRGF0ZSkgKyBGSElSSGVscGVycy5Ub1F1YW50aXR5KChjb25kaXRpb24uYWJhdGVtZW50IGFzIEZISVIuUmFuZ2UpLmhpZ2gpICsgMSB5ZWFyKQ0KICBlbHNlIGlmIGNvbmRpdGlvbi5hYmF0ZW1lbnQgaXMgRkhJUi5ib29sZWFuIHRoZW4NCiAgICBJbnRlcnZhbFtlbmQgb2YgY29uZGl0aW9uLm9uc2V0LnRvSW50ZXJ2YWwoKSwgY29uZGl0aW9uLnJlY29yZGVkRGF0ZSkNCiAgZWxzZSANCiAgICBudWxsDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgYW4gaW50ZXJ2YWwgcmVwcmVzZW50aW5nIHRoZSBub3JtYWxpemVkIHByZXZhbGVuY2UgcGVyaW9kIG9mIGEgZ2l2ZW4gQ29uZGl0aW9uIHJlc291cmNlLg0KQGNvbW1lbnQ6IFVzZXMgdGhlIHRvSW50ZXJ2YWwgYW5kIHRvQWJhdGVtZW50SW50ZXJ2YWwgZnVuY3Rpb25zIHRvIGRldGVybWluZSB0aGUgd2lkZXN0IHBvdGVudGlhbCBpbnRlcnZhbCBmcm9tDQpvbnNldCB0byBhYmF0ZW1lbnQgYXMgc3BlY2lmaWVkIGluIHRoZSBnaXZlbiBDb25kaXRpb24uDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBwcmV2YWxlbmNlSW50ZXJ2YWwoY29uZGl0aW9uIENvbmRpdGlvbik6DQppZiBjb25kaXRpb24uY2xpbmljYWxTdGF0dXMgfiAiYWN0aXZlIg0KICBvciBjb25kaXRpb24uY2xpbmljYWxTdGF0dXMgfiAicmVjdXJyZW5jZSINCiAgb3IgY29uZGl0aW9uLmNsaW5pY2FsU3RhdHVzIH4gInJlbGFwc2UiIHRoZW4NCiAgSW50ZXJ2YWxbc3RhcnQgb2YgY29uZGl0aW9uLm9uc2V0LnRvSW50ZXJ2YWwoKSwgZW5kIG9mIGNvbmRpdGlvbi5hYmF0ZW1lbnRJbnRlcnZhbCgpXQ0KZWxzZQ0KICAoZW5kIG9mIGNvbmRpdGlvbi5hYmF0ZW1lbnRJbnRlcnZhbCgpKSBhYmF0ZW1lbnREYXRlDQogICAgcmV0dXJuIA0KCSAgaWYgYWJhdGVtZW50RGF0ZSBpcyBudWxsIHRoZW4NCiAgICAgICAgSW50ZXJ2YWxbc3RhcnQgb2YgY29uZGl0aW9uLm9uc2V0LnRvSW50ZXJ2YWwoKSwgYWJhdGVtZW50RGF0ZSkNCiAgICAgIGVsc2UNCiAgICAgICAgSW50ZXJ2YWxbc3RhcnQgb2YgY29uZGl0aW9uLm9uc2V0LnRvSW50ZXJ2YWwoKSwgYWJhdGVtZW50RGF0ZV0NCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiByZWZlcmVuY2UgaXMgdG8gdGhlIGdpdmVuIHJlc291cmNlDQpAY29tbWVudDogUmV0dXJucyB0cnVlIGlmIHRoZSBgaWRgIGVsZW1lbnQgb2YgdGhlIGdpdmVuIHJlc291cmNlIGV4YWN0bHkgZXF1YWxzIHRoZSB0YWlsIG9mIHRoZSBnaXZlbiByZWZlcmVuY2UuDQpOT1RFOiBUaGlzIGZ1bmN0aW9uIGFzc3VtZXMgcmVzb3VyY2VzIGZyb20gdGhlIHNhbWUgc291cmNlIHNlcnZlci4NCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIHJlZmVyZW5jZXMocmVmZXJlbmNlIEZISVIuUmVmZXJlbmNlLCByZXNvdXJjZSBGSElSLlJlc291cmNlKToNCiAgcmVzb3VyY2UuaWQgPSBMYXN0KFNwbGl0KHJlZmVyZW5jZS5yZWZlcmVuY2UsICcvJykpICANCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiByZWZlcmVuY2UgaXMgdG8gdGhlIGdpdmVuIHJlc291cmNlSWQNCkBjb21tZW50OiBSZXR1cm5zIHRydWUgaWYgdGhlIGByZXNvdXJjZUlkYCBwYXJhbWV0ZXIgZXhhY3RseSBlcXVhbHMgdGhlIHRhaWwgb2YgdGhlIGdpdmVuIHJlZmVyZW5jZS4NCk5PVEU6IFRoaXMgZnVuY3Rpb24gYXNzdW1lcyByZXNvdXJjZXMgZnJvbSB0aGUgc2FtZSBzb3VyY2Ugc2VydmVyLg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gcmVmZXJlbmNlcyhyZWZlcmVuY2UgRkhJUi5SZWZlcmVuY2UsIHJlc291cmNlSWQgU3RyaW5nKToNCiAgcmVzb3VyY2VJZCA9IExhc3QoU3BsaXQocmVmZXJlbmNlLnJlZmVyZW5jZSwgJy8nKSkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0cnVlIGlmIGFueSBvZiB0aGUgZ2l2ZW4gcmVmZXJlbmNlcyBhcmUgdG8gdGhlIGdpdmVuIHJlc291cmNlDQpAY29tbWVudDogUmV0dXJucyB0cnVlIGlmIHRoZSBgaWRgIGVsZW1lbnQgb2YgdGhlIGdpdmVuIHJlc291cmNlIGV4YWN0bHkgZXF1YWxzIHRoZSB0YWlsIG9mIGFueSBvZiB0aGUgZ2l2ZW4gcmVmZXJlbmNlcy4NCk5PVEU6IFRoaXMgZnVuY3Rpb24gYXNzdW1lcyByZXNvdXJjZXMgZnJvbSB0aGUgc2FtZSBzb3VyY2Ugc2VydmVyLg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gcmVmZXJlbmNlcyhyZWZlcmVuY2VzIExpc3Q8RkhJUi5SZWZlcmVuY2U+LCByZXNvdXJjZSBGSElSLlJlc291cmNlKToNCiAgZXhpc3RzIChyZWZlcmVuY2VzIFIgd2hlcmUgUi5yZWZlcmVuY2VzKHJlc291cmNlKSkNCiAgDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRydWUgaWYgYW55IG9mIHRoZSBnaXZlbiByZWZlcmVuY2VzIGFyZSB0byB0aGUgZ2l2ZW4gcmVzb3VyY2VJZA0KQGNvbW1lbnQ6IFJldHVybnMgdHJ1ZSBpZiB0aGUgYHJlc291cmNlSWRgIHBhcmFtZXRlciBleGFjdGx5IGVxdWFscyB0aGUgdGFpbCBvZiBhbnkgb2YgdGhlIGdpdmVuIHJlZmVyZW5jZXMuDQpOT1RFOiBUaGlzIGZ1bmN0aW9uIGFzc3VtZXMgcmVzb3VyY2VzIGZyb20gdGhlIHNhbWUgc291cmNlIHNlcnZlci4NCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIHJlZmVyZW5jZXMocmVmZXJlbmNlcyBMaXN0PEZISVIuUmVmZXJlbmNlPiwgcmVzb3VyY2VJZCBTdHJpbmcpOg0KICBleGlzdHMgKHJlZmVyZW5jZXMgUiB3aGVyZSBSLnJlZmVyZW5jZXMocmVzb3VyY2VJZCkpDQo="^^xsd:base64Binary ]
  ] ) . # 

# -------------------------------------------------------------------------------------

