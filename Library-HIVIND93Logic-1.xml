<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1">
   <annotation translatorOptions="EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion" signatureLevel="None" xsi:type="a:CqlToElmInfo"/>
   <annotation message="The function FHIRHelpers.ToInterval has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation message="The function FHIRHelpers.ToInterval has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation xsi:type="a:Annotation">
      <a:s r="17">
         <a:s>/**
 * Library: HIV.IND.93 Logic
 * Ref No: CCA.1
 * Short Name: Cervical cancer screening
 *
 * Definition: Number of women living with HIV who were screened for cervical cancer using any screening test
 *
 * Numerator: Number of women living with HIV who were screened for cervical cancer using any screening test (HPV DNA test, visual inspection with acetic acid, cytology, other)
 * Numerator Calculation: COUNT of women with &quot;HIV status&quot;='HIV-positive' AND with a &quot;Date of cervical cancer screening test&quot; in the reporting period
 * Numerator Exclusions: 
 *
 * Denominator: 1
 * Denominator Calculation: 1
 * Denominator Exclusions: 
 *
 * Disaggregations:
 * • Age (15–19, 20–24, 25–29, 30–49, 50+ years) 
 *  • Lifetime screening test number (First in lifetime, second in lifetime, etc.) 
 *  • Cities and other administrative areas of epidemiologic importance
 *
 * Disaggregation Elements: Age | Lifetime screening test number
 *
 * Numerator and Denominator Elements:
 * Date of cervical cancer screening test 
 *  HIV status
 *
 * Reference: Consolidated guidelines on person-centred HIV strategic information: strengthening routine data for impact. Geneva: World Health Organization; 2022
 * 
 * Data Concepts:
 * HIV.A.DE17: Age | Calculated age (number of years) of the client based on date of birth
 * HIV.B.DE115: HIV status | HIV status reported after applying the national HIV testing algorithm. No single HIV test can provide an HIV-positive diagnosis.
 * HIV.B.DE116: HIV-positive | Client is HIV-positive
 * HIV.B.DE117: HIV-negative | Client is HIV-negative
 * HIV.B.DE118: Unknown | Client has unknown HIV status
 * HIV.D.DE656: Date of cervical cancer screening test | Date of cervical cancer screening test
 * HIV.D.DE657: Lifetime screening test number | Client's lifetime number of screenings for cervical cancer
 *
 * Additional Context
 * - what it measures: Progress towards scaling up population-based screening for the prevention of cervical cancer among women living with HIV.
 * - rationale: To measure progress towards scaling up screening for the prevention of cervical cancer among women living with HIV. Since the screening interval between tests depends on the test used, the number of women screened may vary from year to year.
 * - method: Health facility patient registers, patient records |  | The number is generated by counting the number of women living with HIV among all women who were screened for cervical cancer in the last 12 months, using health facility patient registers or patient records as the source. |  | Each individual should be counted only once in the reporting period. If a second triage test or a follow-up test was performed as part of the screening strategy, that individual should be counted only once.
 * 
 * Suggested Scoring Method: continuous-variable | http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cv-measure-cqfm
 */

library HIVIND93Logic</a:s>
      </a:s>
   </annotation>
   <identifier id="HIVIND93Logic" system="http://smart.who.int/hiv"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localId="1" locator="49:1-49:26" localIdentifier="FHIR" uri="http://hl7.org/fhir" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="1">
               <a:s>// Included Libraries
using </a:s>
               <a:s>
                  <a:s>FHIR</a:s>
               </a:s>
               <a:s> version '4.0.1'</a:s>
            </a:s>
         </annotation>
      </def>
   </usings>
   <includes>
      <def localId="2" locator="51:1-51:44" localIdentifier="HIC" path="http://smart.who.int/hiv/HIVCommon" version="0.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="2">
               <a:s>include </a:s>
               <a:s>
                  <a:s>HIVCommon</a:s>
               </a:s>
               <a:s> version '0.0.1' called HIC</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="3" locator="52:1-52:35" localIdentifier="FHIRHelpers" path="http://hl7.org/fhir/FHIRHelpers" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="3">
               <a:s>include </a:s>
               <a:s>
                  <a:s>FHIRHelpers</a:s>
               </a:s>
               <a:s> version '4.0.1'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="4" locator="54:1-54:29" localIdentifier="WCom" path="http://smart.who.int/hiv/WHOCommon">
         <annotation xsi:type="a:Annotation">
            <a:s r="4">
               <a:s>include </a:s>
               <a:s>
                  <a:s>WHOCommon</a:s>
               </a:s>
               <a:s> called WCom</a:s>
            </a:s>
         </annotation>
      </def>
   </includes>
   <parameters>
      <def localId="10" locator="57:1-57:88" name="Measurement Period" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="10">
               <a:s>// Indicator Definition
parameter &quot;Measurement Period&quot; </a:s>
               <a:s r="9">
                  <a:s>Interval&lt;</a:s>
                  <a:s r="8">
                     <a:s>Date</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
               <a:s> default </a:s>
               <a:s r="7">
                  <a:s r="5">Interval[@2023-01-01, @2023-01-30]</a:s>
               </a:s>
            </a:s>
         </annotation>
         <default localId="7" locator="57:55-57:88" lowClosed="true" highClosed="true" xsi:type="Interval">
            <low localId="5" locator="57:64-57:74" xsi:type="Date">
               <year valueType="t:Integer" value="2023" xsi:type="Literal"/>
               <month valueType="t:Integer" value="1" xsi:type="Literal"/>
               <day valueType="t:Integer" value="1" xsi:type="Literal"/>
            </low>
            <high localId="6" locator="57:77-57:87" xsi:type="Date">
               <year valueType="t:Integer" value="2023" xsi:type="Literal"/>
               <month valueType="t:Integer" value="1" xsi:type="Literal"/>
               <day valueType="t:Integer" value="30" xsi:type="Literal"/>
            </high>
         </default>
         <parameterTypeSpecifier localId="9" locator="57:32-57:45" xsi:type="IntervalTypeSpecifier">
            <pointType localId="8" locator="57:41-57:44" name="t:Date" xsi:type="NamedTypeSpecifier"/>
         </parameterTypeSpecifier>
      </def>
   </parameters>
   <contexts>
      <def locator="59:1-59:15" name="Patient"/>
   </contexts>
   <statements>
      <def locator="59:1-59:15" name="Patient" context="Patient">
         <expression xsi:type="SingletonFrom">
            <operand locator="59:1-59:15" dataType="fhir:Patient" templateId="http://hl7.org/fhir/StructureDefinition/Patient" xsi:type="Retrieve"/>
         </expression>
      </def>
      <def localId="12" locator="66:1-67:6" name="Initial Population" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="12">
               <a:s r="11">/* Populations */

/*
 *Initial Population
 */

define &quot;Initial Population&quot;:
  true</a:s>
            </a:s>
         </annotation>
         <expression localId="11" locator="67:3-67:6" valueType="t:Boolean" value="true" xsi:type="Literal"/>
      </def>
      <def localId="14" locator="76:1-77:6" name="Measure Population" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="14">
               <a:s r="13">/**
 * Measure Population
 *
 * Definition: Number of women living with HIV who were screened for cervical cancer using any screening test (HPV DNA test, visual inspection with acetic acid, cytology, other)
 * Calculation: Number of women living with HIV who were screened for cervical cancer using any screening test (HPV DNA test, visual inspection with acetic acid, cytology, other)
 */
                                                       
define &quot;Measure Population&quot;:
  true</a:s>
            </a:s>
         </annotation>
         <expression localId="13" locator="77:3-77:6" valueType="t:Boolean" value="true" xsi:type="Literal"/>
      </def>
      <def localId="17" locator="86:1-87:3" name="Measure Observation" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="17">
               <a:s>/**
 * Measure Observation
 * Definition: Number of women living with HIV who were screened for cervical cancer using any screening test (HPV DNA test, visual inspection with acetic acid, cytology, other)
 * Calculation: Number of women living with HIV who were screened for cervical cancer using any screening test (HPV DNA test, visual inspection with acetic acid, cytology, other)                                                      
 */     

define function &quot;Measure Observation&quot;(Patient &quot;Patient&quot;):
  </a:s>
               <a:s r="16">
                  <a:s r="16">1</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="16" locator="87:3" valueType="t:Integer" value="1" xsi:type="Literal"/>
         <operand name="Patient">
            <operandTypeSpecifier localId="15" locator="86:47-86:55" name="fhir:Patient" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
   </statements>
</library>
