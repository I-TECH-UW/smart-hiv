<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1">
   <annotation translatorOptions="EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion" signatureLevel="None" xsi:type="a:CqlToElmInfo"/>
   <annotation message="The function FHIRHelpers.ToInterval has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation message="The function FHIRHelpers.ToInterval has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation message="The function WHOCommon.references has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation message="The function WHOCommon.references has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation message="The function FHIRHelpers.ToDateTime has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation message="The function FHIRHelpers.ToDateTime has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation message="The function WHOCommon.references has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation message="The function WHOCommon.references has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation message="The function FHIRHelpers.ToDateTime has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation message="The function FHIRHelpers.ToDateTime has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation message="The function FHIRHelpers.ToString has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation xsi:type="a:Annotation">
      <a:s r="117">
         <a:s>/**
 * Library: HIV.IND.22 Logic
 * Ref No: HTS.5
 * Short Name: HTS partner services
 *
 * Definition: Number of people who were identified and tested using partner testing services and who received their results
 *
 * Numerator: For the general population: Number of elicited partners and other contacts* of people diagnosed with HIV who received HTS |  | Additional cascade data collected: | • Number of people diagnosed with HIV (index cases) offered partner services | • Number of people diagnosed with HIV (index cases) accepting partner services | • Number of contacts/partners of people living with HIV whose information is elicited from people diagnosed with HIV (index cases) |  | For key populations: Number of elicited contacts1 of members of key populations who received HTS. | Additional cascade data collected: | • Number of key population members offered social network-based/partner services | • Number of key population members accepting social network-based/partner services | • Number of contacts of key population members elicited
 * Numerator Calculation: COUNT of clients &quot;Referred through partner services&quot; that are a 'Partner or contact of an index case' AND &quot;Type of contact or partner for partner services&quot; IN 'Sexual partner', 'Drug-injecting partner' with &quot;HIV test date&quot; AND &quot;Date HIV test results returned&quot; in the reporting period
 * Numerator Exclusions: 
 *
 * Denominator: 1
 * Denominator Calculation: 1
 * Denominator Exclusions: 
 *
 * Disaggregations:
 * • By index case gender (male, female, other**) 
 *  • Age (0–4, 5–9, 10–14, 15–19, 20–24, 25–49, 50+ years)*** 
 *  • HIV status of partner or contact (already known positive, newly diagnosed positive, negative) 
 *  • Key populations (men who have sex with men, people living in prisons and other closed settings, people who inject drugs, sex workers, trans and gender diverse people)**** 
 *  • Cities and other administrative regions of epidemiologic importance
 *
 * Disaggregation Elements: *Gender [of index case] | Age | Partner HIV status (reported) | HIV status of contact | Key population member type
 *
 * Numerator and Denominator Elements:
 * Date HIV test results returned 
 *  HIV test date 
 *  Referred through partner services 
 *  Type of contact or partner for partner services
 *
 * Reference: Consolidated guidelines on person-centred HIV strategic information: strengthening routine data for impact. Geneva: World Health Organization; 2022
 * 
 * Data Concepts:
 * HIV.A.DE17: Age | Calculated age (number of years) of the client based on date of birth
 * HIV.B.DE5: Referred through partner services | Client reported coming to the facility after receiving a provider-assisted referral or patient referral from a contact or partner
 * HIV.B.DE6: Partner or contact of an index case | The client is a contact or partner of a person diagnosed with HIV (an index case)
 * HIV.B.DE7: Partner or contact of an HIV testing client (non-index case) | The client is a contact or partner identified through partner or social network services, but is not known to be a partner of an index-case
 * HIV.B.DE8: Type of contact or partner for partner services | Client's relationship to the person that referred the client for partner services or family services
 * HIV.B.DE9: Biological child | Client is the biological child of the person that referred the client for family services
 * HIV.B.DE10: Drug-injecting partner | Client is a drug-injecting partner of the person that referred the client for partner services
 * HIV.B.DE11: Sexual partner | Client is a sexual partner of the person that referred the client for partner services
 * HIV.B.DE12: Social contact | Client is a social contact of the person that referred the client for social-network services
 * HIV.B.DE33: Partner HIV status (reported) | The HIV status of the client's partner.
 * HIV.B.DE34: HIV-positive | Client's partner is HIV-positive
 * HIV.B.DE35: HIV-negative | Client's partner is HIV-negative
 * HIV.B.DE36: Unknown | Don't know HIV status - client does not know partner's HIV status
 * HIV.B.DE50: Key population member type* | The type of key population that the client is included in
 * HIV.B.DE51: Sex worker | Client is a sex worker
 * HIV.B.DE52: Men who have sex with men | Client is a man who has sex with men
 * HIV.B.DE53: Trans and gender-diverse people | Client identifies as trans and gender-diverse
 * HIV.B.DE54: People who inject drugs | Client is a person who injects drugs
 * HIV.B.DE55: People living in prisons and other closed settings | Client lives in a prison or another closed setting
 * HIV.B.DE60: Date HIV test results returned | Date HIV test result returned to client
 * HIV.B.DE110: HIV test date | Date of the HIV test
 * HIV.E.DE114: Key population member type* | The type of key population that the infant's mother is included in
 * HIV.E.DE115: Sex worker | Infant's mother is a sex worker
 * HIV.E.DE116: People who inject drugs | Infant's mother is a person who injects drugs
 * HIV.E.DE117: Trans and gender-diverse people | Infant's mother identifies as trans and gender-diverse
 * HIV.E.DE118: People living in prisons and other closed setting | Infant's mother is in a prison or closed setting
 * HIV.E.DE224: HIV test date | Date of the HIV test
 * HIV.PRV.DE11: HIV status of contact | The HIV status of the client's contact
 * HIV.PRV.DE12: HIV-positive | Client's contact is HIV-positive
 * HIV.PRV.DE13: HIV-negative | Client's contact is HIV-negative
 * HIV.PRV.DE14: Unknown | Client does not know contact's HIV status
 * HIV.SRV.DE1: HIV test date | Date of the HIV test
 *
 * Additional Context
 * - what it measures: This measures the coverage and impact of the testing cascade of services for partners and other contacts* of people living with HIV, including key population members.
 * - rationale: • Contact testing, including among sexual partners, has been shown to increase the diagnosis of already-infected contacts and partners of newly identified HIV cases. | • Among serodiscordant couples, partner notification and testing can be a critical step in preventing infection of the uninfected partner. | • Contact and/or partner notification and testing should be voluntary and provided with supportive services.
 * - method: Patient monitoring data (HIV index testing services register or logbook, HTS registers or reporting forms) or EMR
 * 
 * Suggested Scoring Method: continuous-variable | http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cv-measure-cqfm
 */

library HIVIND22Logic</a:s>
      </a:s>
   </annotation>
   <identifier id="HIVIND22Logic" system="http://smart.who.int/hiv"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localId="1" locator="78:1-78:26" localIdentifier="FHIR" uri="http://hl7.org/fhir" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="1">
               <a:s>// Included Libraries
using </a:s>
               <a:s>
                  <a:s>FHIR</a:s>
               </a:s>
               <a:s> version '4.0.1'</a:s>
            </a:s>
         </annotation>
      </def>
   </usings>
   <includes>
      <def localId="2" locator="80:1-80:44" localIdentifier="HIC" path="http://smart.who.int/hiv/HIVCommon" version="0.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="2">
               <a:s>include </a:s>
               <a:s>
                  <a:s>HIVCommon</a:s>
               </a:s>
               <a:s> version '0.0.1' called HIC</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="3" locator="81:1-81:35" localIdentifier="FHIRHelpers" path="http://hl7.org/fhir/FHIRHelpers" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="3">
               <a:s>include </a:s>
               <a:s>
                  <a:s>FHIRHelpers</a:s>
               </a:s>
               <a:s> version '4.0.1'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="4" locator="82:1-82:29" localIdentifier="WCom" path="http://smart.who.int/hiv/WHOCommon">
         <annotation xsi:type="a:Annotation">
            <a:s r="4">
               <a:s>include </a:s>
               <a:s>
                  <a:s>WHOCommon</a:s>
               </a:s>
               <a:s> called WCom</a:s>
            </a:s>
         </annotation>
      </def>
   </includes>
   <parameters>
      <def localId="10" locator="85:1-85:88" name="Measurement Period" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="10">
               <a:s>// Indicator Definition
parameter &quot;Measurement Period&quot; </a:s>
               <a:s r="9">
                  <a:s>Interval&lt;</a:s>
                  <a:s r="8">
                     <a:s>Date</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
               <a:s> default </a:s>
               <a:s r="7">
                  <a:s r="5">Interval[@2023-01-01, @2023-01-30]</a:s>
               </a:s>
            </a:s>
         </annotation>
         <default localId="7" locator="85:55-85:88" lowClosed="true" highClosed="true" xsi:type="Interval">
            <low localId="5" locator="85:64-85:74" xsi:type="Date">
               <year valueType="t:Integer" value="2023" xsi:type="Literal"/>
               <month valueType="t:Integer" value="1" xsi:type="Literal"/>
               <day valueType="t:Integer" value="1" xsi:type="Literal"/>
            </low>
            <high localId="6" locator="85:77-85:87" xsi:type="Date">
               <year valueType="t:Integer" value="2023" xsi:type="Literal"/>
               <month valueType="t:Integer" value="1" xsi:type="Literal"/>
               <day valueType="t:Integer" value="30" xsi:type="Literal"/>
            </high>
         </default>
         <parameterTypeSpecifier localId="9" locator="85:32-85:45" xsi:type="IntervalTypeSpecifier">
            <pointType localId="8" locator="85:41-85:44" name="t:Date" xsi:type="NamedTypeSpecifier"/>
         </parameterTypeSpecifier>
      </def>
   </parameters>
   <contexts>
      <def locator="87:1-87:15" name="Patient"/>
   </contexts>
   <statements>
      <def locator="87:1-87:15" name="Patient" context="Patient">
         <expression xsi:type="SingletonFrom">
            <operand locator="87:1-87:15" dataType="fhir:Patient" templateId="http://hl7.org/fhir/StructureDefinition/Patient" xsi:type="Retrieve"/>
         </expression>
      </def>
      <def localId="12" locator="94:1-95:6" name="Initial Population" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="12">
               <a:s r="11">/* Populations */

/*
 *Initial Population
 */

define &quot;Initial Population&quot;:
  true</a:s>
            </a:s>
         </annotation>
         <expression localId="11" locator="95:3-95:6" valueType="t:Boolean" value="true" xsi:type="Literal"/>
      </def>
      <def localId="74" locator="104:1-119:56" name="Measure Population" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="74">
               <a:s>/**
 * Measure Population
 *
 * Definition: For the general population: Number of elicited partners and other contacts* of people diagnosed with HIV who received HTS |  | Additional cascade data collected: | • Number of people diagnosed with HIV (index cases) offered partner services | • Number of people diagnosed with HIV (index cases) accepting partner services | • Number of contacts/partners of people living with HIV whose information is elicited from people diagnosed with HIV (index cases) |  | For key populations: Number of elicited contacts1 of members of key populations who received HTS. | Additional cascade data collected: | • Number of key population members offered social network-based/partner services | • Number of key population members accepting social network-based/partner services | • Number of contacts of key population members elicited
 * Calculation: For the general population: Number of elicited partners and other contacts* of people diagnosed with HIV who received HTS |  | Additional cascade data collected: | • Number of people diagnosed with HIV (index cases) offered partner services | • Number of people diagnosed with HIV (index cases) accepting partner services | • Number of contacts/partners of people living with HIV whose information is elicited from people diagnosed with HIV (index cases) |  | For key populations: Number of elicited contacts1 of members of key populations who received HTS. | Additional cascade data collected: | • Number of key population members offered social network-based/partner services | • Number of key population members accepting social network-based/partner services | • Number of contacts of key population members elicited
 */
                                                       
define &quot;Measure Population&quot;:
    </a:s>
               <a:s r="73">
                  <a:s r="42">
                     <a:s>exists</a:s>
                     <a:s r="41">
                        <a:s>(</a:s>
                        <a:s r="41">
                           <a:s>
                              <a:s r="14">
                                 <a:s r="13">
                                    <a:s>
                                       <a:s>HIC.&quot;Partner or contact of an index case&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> IC</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
    </a:s>
                           <a:s r="21">
                              <a:s>with </a:s>
                              <a:s r="16">
                                 <a:s r="15">
                                    <a:s>
                                       <a:s>HIC.&quot;Drug-injecting partner&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> DIP</a:s>
                              </a:s>
                              <a:s>
      such that </a:s>
                              <a:s r="20">
                                 <a:s r="18">
                                    <a:s r="17">
                                       <a:s>IC</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="18">
                                       <a:s>hasMember</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="20">
                                    <a:s>references(</a:s>
                                    <a:s r="19">
                                       <a:s>DIP</a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      </a:s>
                           <a:s r="40">
                              <a:s>with </a:s>
                              <a:s r="23">
                                 <a:s r="22">
                                    <a:s>
                                       <a:s>HIC.&quot;HIV test resulted&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> HIV</a:s>
                              </a:s>
                              <a:s>
      such that </a:s>
                              <a:s r="39">
                                 <a:s r="33">
                                    <a:s r="27">
                                       <a:s r="25">
                                          <a:s r="24">
                                             <a:s>IC</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="25">
                                             <a:s>hasMember</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="27">
                                          <a:s>references(</a:s>
                                          <a:s r="26">
                                             <a:s>HIV</a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
      and </a:s>
                                    <a:s r="32">
                                       <a:s r="29">
                                          <a:s r="28">
                                             <a:s>HIV</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="29">
                                             <a:s>issued</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s r="32"> after </a:s>
                                       <a:s r="31">
                                          <a:s>start of </a:s>
                                          <a:s r="30">
                                             <a:s>&quot;Measurement Period&quot;</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
      and </a:s>
                                 <a:s r="38">
                                    <a:s r="35">
                                       <a:s r="34">
                                          <a:s>HIV</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="35">
                                          <a:s>issued</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s r="38"> before </a:s>
                                    <a:s r="37">
                                       <a:s>end of </a:s>
                                       <a:s r="36">
                                          <a:s>&quot;Measurement Period&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    or 
    </a:s>
                  <a:s r="72">
                     <a:s>exists</a:s>
                     <a:s r="71">
                        <a:s>(</a:s>
                        <a:s r="71">
                           <a:s>
                              <a:s r="44">
                                 <a:s r="43">
                                    <a:s>
                                       <a:s>HIC.&quot;Partner or contact of an index case&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> IC</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
    </a:s>
                           <a:s r="51">
                              <a:s>with </a:s>
                              <a:s r="46">
                                 <a:s r="45">
                                    <a:s>
                                       <a:s>HIC.&quot;Sexual partner&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> SP</a:s>
                              </a:s>
                              <a:s>
      such that </a:s>
                              <a:s r="50">
                                 <a:s r="48">
                                    <a:s r="47">
                                       <a:s>IC</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="48">
                                       <a:s>hasMember</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="50">
                                    <a:s>references(</a:s>
                                    <a:s r="49">
                                       <a:s>SP</a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      </a:s>
                           <a:s r="70">
                              <a:s>with </a:s>
                              <a:s r="53">
                                 <a:s r="52">
                                    <a:s>
                                       <a:s>HIC.&quot;HIV test resulted&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> HIV</a:s>
                              </a:s>
                              <a:s>
      such that </a:s>
                              <a:s r="69">
                                 <a:s r="63">
                                    <a:s r="57">
                                       <a:s r="55">
                                          <a:s r="54">
                                             <a:s>IC</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="55">
                                             <a:s>hasMember</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="57">
                                          <a:s>references(</a:s>
                                          <a:s r="56">
                                             <a:s>HIV</a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
      and </a:s>
                                    <a:s r="62">
                                       <a:s r="59">
                                          <a:s r="58">
                                             <a:s>HIV</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="59">
                                             <a:s>issued</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s r="62"> after </a:s>
                                       <a:s r="61">
                                          <a:s>start of </a:s>
                                          <a:s r="60">
                                             <a:s>&quot;Measurement Period&quot;</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
      and </a:s>
                                 <a:s r="68">
                                    <a:s r="65">
                                       <a:s r="64">
                                          <a:s>HIV</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="65">
                                          <a:s>issued</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s r="68"> before </a:s>
                                    <a:s r="67">
                                       <a:s>end of </a:s>
                                       <a:s r="66">
                                          <a:s>&quot;Measurement Period&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="73" locator="105:5-119:56" xsi:type="Or">
            <operand localId="42" locator="105:5-111:56" xsi:type="Exists">
               <operand localId="41" locator="105:11-111:56" xsi:type="Query">
                  <source localId="14" locator="105:12-105:55" alias="IC">
                     <expression localId="13" locator="105:12-105:52" name="Partner or contact of an index case" libraryName="HIC" xsi:type="ExpressionRef"/>
                  </source>
                  <relationship localId="21" locator="106:5-107:44" alias="DIP" xsi:type="With">
                     <expression localId="15" locator="106:10-106:37" name="Drug-injecting partner" libraryName="HIC" xsi:type="ExpressionRef"/>
                     <suchThat localId="20" locator="107:17-107:44" name="references" libraryName="WCom" xsi:type="FunctionRef">
                        <operand localId="18" locator="107:17-107:28" path="hasMember" scope="IC" xsi:type="Property"/>
                        <operand localId="19" locator="107:41-107:43" name="DIP" xsi:type="AliasRef"/>
                     </suchThat>
                  </relationship>
                  <relationship localId="40" locator="108:7-111:55" alias="HIV" xsi:type="With">
                     <expression localId="22" locator="108:12-108:34" name="HIV test resulted" libraryName="HIC" xsi:type="ExpressionRef"/>
                     <suchThat localId="39" locator="109:17-111:55" xsi:type="And">
                        <operand localId="33" locator="109:17-110:56" xsi:type="And">
                           <operand localId="27" locator="109:17-109:44" name="references" libraryName="WCom" xsi:type="FunctionRef">
                              <operand localId="25" locator="109:17-109:28" path="hasMember" scope="IC" xsi:type="Property"/>
                              <operand localId="26" locator="109:41-109:43" name="HIV" xsi:type="AliasRef"/>
                           </operand>
                           <operand localId="32" locator="110:11-110:56" xsi:type="After">
                              <operand name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <operand localId="29" locator="110:11-110:20" path="issued" scope="HIV" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="ToDateTime">
                                 <operand localId="31" locator="110:28-110:56" xsi:type="Start">
                                    <operand localId="30" locator="110:37-110:56" name="Measurement Period" xsi:type="ParameterRef"/>
                                 </operand>
                              </operand>
                           </operand>
                        </operand>
                        <operand localId="38" locator="111:11-111:55" xsi:type="Before">
                           <operand name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <operand localId="35" locator="111:11-111:20" path="issued" scope="HIV" xsi:type="Property"/>
                           </operand>
                           <operand xsi:type="ToDateTime">
                              <operand localId="37" locator="111:29-111:55" xsi:type="End">
                                 <operand localId="36" locator="111:36-111:55" name="Measurement Period" xsi:type="ParameterRef"/>
                              </operand>
                           </operand>
                        </operand>
                     </suchThat>
                  </relationship>
               </operand>
            </operand>
            <operand localId="72" locator="113:5-119:56" xsi:type="Exists">
               <operand localId="71" locator="113:11-119:56" xsi:type="Query">
                  <source localId="44" locator="113:12-113:55" alias="IC">
                     <expression localId="43" locator="113:12-113:52" name="Partner or contact of an index case" libraryName="HIC" xsi:type="ExpressionRef"/>
                  </source>
                  <relationship localId="51" locator="114:5-115:43" alias="SP" xsi:type="With">
                     <expression localId="45" locator="114:10-114:29" name="Sexual partner" libraryName="HIC" xsi:type="ExpressionRef"/>
                     <suchThat localId="50" locator="115:17-115:43" name="references" libraryName="WCom" xsi:type="FunctionRef">
                        <operand localId="48" locator="115:17-115:28" path="hasMember" scope="IC" xsi:type="Property"/>
                        <operand localId="49" locator="115:41-115:42" name="SP" xsi:type="AliasRef"/>
                     </suchThat>
                  </relationship>
                  <relationship localId="70" locator="116:7-119:55" alias="HIV" xsi:type="With">
                     <expression localId="52" locator="116:12-116:34" name="HIV test resulted" libraryName="HIC" xsi:type="ExpressionRef"/>
                     <suchThat localId="69" locator="117:17-119:55" xsi:type="And">
                        <operand localId="63" locator="117:17-118:56" xsi:type="And">
                           <operand localId="57" locator="117:17-117:44" name="references" libraryName="WCom" xsi:type="FunctionRef">
                              <operand localId="55" locator="117:17-117:28" path="hasMember" scope="IC" xsi:type="Property"/>
                              <operand localId="56" locator="117:41-117:43" name="HIV" xsi:type="AliasRef"/>
                           </operand>
                           <operand localId="62" locator="118:11-118:56" xsi:type="After">
                              <operand name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <operand localId="59" locator="118:11-118:20" path="issued" scope="HIV" xsi:type="Property"/>
                              </operand>
                              <operand xsi:type="ToDateTime">
                                 <operand localId="61" locator="118:28-118:56" xsi:type="Start">
                                    <operand localId="60" locator="118:37-118:56" name="Measurement Period" xsi:type="ParameterRef"/>
                                 </operand>
                              </operand>
                           </operand>
                        </operand>
                        <operand localId="68" locator="119:11-119:55" xsi:type="Before">
                           <operand name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <operand localId="65" locator="119:11-119:20" path="issued" scope="HIV" xsi:type="Property"/>
                           </operand>
                           <operand xsi:type="ToDateTime">
                              <operand localId="67" locator="119:29-119:55" xsi:type="End">
                                 <operand localId="66" locator="119:36-119:55" name="Measurement Period" xsi:type="ParameterRef"/>
                              </operand>
                           </operand>
                        </operand>
                     </suchThat>
                  </relationship>
               </operand>
            </operand>
         </expression>
      </def>
      <def localId="77" locator="129:1-130:3" name="Measure Observation" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="77">
               <a:s>/**
 * Measure Observation
 * Definition: For the general population: Number of elicited partners and other contacts* of people diagnosed with HIV who received HTS |  | Additional cascade data collected: | • Number of people diagnosed with HIV (index cases) offered partner services | • Number of people diagnosed with HIV (index cases) accepting partner services | • Number of contacts/partners of people living with HIV whose information is elicited from people diagnosed with HIV (index cases) |  | For key populations: Number of elicited contacts1 of members of key populations who received HTS. | Additional cascade data collected: | • Number of key population members offered social network-based/partner services | • Number of key population members accepting social network-based/partner services | • Number of contacts of key population members elicited
 * Calculation: For the general population: Number of elicited partners and other contacts* of people diagnosed with HIV who received HTS |  | Additional cascade data collected: | • Number of people diagnosed with HIV (index cases) offered partner services | • Number of people diagnosed with HIV (index cases) accepting partner services | • Number of contacts/partners of people living with HIV whose information is elicited from people diagnosed with HIV (index cases) |  | For key populations: Number of elicited contacts1 of members of key populations who received HTS. | Additional cascade data collected: | • Number of key population members offered social network-based/partner services | • Number of key population members accepting social network-based/partner services | • Number of contacts of key population members elicited                                                      
 */     

define function &quot;Measure Observation&quot;(Patient &quot;Patient&quot;):
  </a:s>
               <a:s r="76">
                  <a:s r="76">1</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="76" locator="130:3" valueType="t:Integer" value="1" xsi:type="Literal"/>
         <operand name="Patient">
            <operandTypeSpecifier localId="75" locator="129:47-129:55" name="fhir:Patient" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="80" locator="137:1-138:42" name="Administrative Gender Stratifier" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="80">
               <a:s>/* end Populations */

/*
 * Disaggregators
 */

define &quot;Administrative Gender Stratifier&quot;:
	</a:s>
               <a:s r="79">
                  <a:s r="78">
                     <a:s>HIC</a:s>
                  </a:s>
                  <a:s>.</a:s>
                  <a:s r="79">
                     <a:s>&quot;By Administrative Gender Stratifier&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="79" locator="138:2-138:42" name="By Administrative Gender Stratifier" libraryName="HIC" xsi:type="ExpressionRef"/>
      </def>
      <def localId="83" locator="140:1-141:26" name="Age Stratifier" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="83">
               <a:s>define &quot;Age Stratifier&quot;:
	</a:s>
               <a:s r="82">
                  <a:s r="81">
                     <a:s>HIC</a:s>
                  </a:s>
                  <a:s>.</a:s>
                  <a:s r="82">
                     <a:s>&quot;By Age Stratifier 2&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="82" locator="141:2-141:26" name="By Age Stratifier 2" libraryName="HIC" xsi:type="ExpressionRef"/>
      </def>
      <def localId="86" locator="143:1-144:38" name="Geographic Region Stratifier" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="86">
               <a:s>define &quot;Geographic Region Stratifier&quot;:
	</a:s>
               <a:s r="85">
                  <a:s r="84">
                     <a:s>HIC</a:s>
                  </a:s>
                  <a:s>.</a:s>
                  <a:s r="85">
                     <a:s>&quot;By Geographic Region Stratifier&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="85" locator="144:2-144:38" name="By Geographic Region Stratifier" libraryName="HIC" xsi:type="ExpressionRef"/>
      </def>
      <def localId="89" locator="146:1-147:20" name="patientGroups Stratifier" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="89">
               <a:s>define &quot;patientGroups Stratifier&quot;:
	</a:s>
               <a:s r="88">
                  <a:s r="87">
                     <a:s>HIC</a:s>
                  </a:s>
                  <a:s>.</a:s>
                  <a:s r="88">
                     <a:s>&quot;patientGroups&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="88" locator="147:2-147:20" name="patientGroups" libraryName="HIC" xsi:type="ExpressionRef"/>
      </def>
      <def localId="92" locator="149:1-150:40" name="HIV status of partner or contact" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="92">
               <a:s>define &quot;HIV status of partner or contact&quot;:
  </a:s>
               <a:s r="91">
                  <a:s r="90">
                     <a:s>HIC</a:s>
                  </a:s>
                  <a:s>.</a:s>
                  <a:s r="91">
                     <a:s>&quot;HIV status of partner or contact&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="91" locator="150:3-150:40" name="HIV status of partner or contact" libraryName="HIC" xsi:type="ExpressionRef"/>
      </def>
      <def localId="117" locator="152:1-157:33" name="Stratification" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="117">
               <a:s>define &quot;Stratification&quot;:
 </a:s>
               <a:s r="116">
                  <a:s r="111">
                     <a:s r="108">
                        <a:s r="106">
                           <a:s r="103">
                              <a:s r="101">
                                 <a:s r="97">
                                    <a:s r="95">
                                       <a:s r="94">
                                          <a:s r="93">
                                             <a:s>HIC</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="94">
                                             <a:s>&quot;By Administrative Gender Stratifier&quot;</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="95">
                                          <a:s>code</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> 
 + </a:s>
                                    <a:s r="96">
                                       <a:s>':'</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> + </a:s>
                                 <a:s r="100">
                                    <a:s r="99">
                                       <a:s r="98">
                                          <a:s>HIC</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="99">
                                          <a:s>&quot;HIV status of partner or contact&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="100">
                                       <a:s>code</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  + </a:s>
                              <a:s r="102">
                                 <a:s>':'</a:s>
                              </a:s>
                           </a:s>
                           <a:s> + </a:s>
                           <a:s r="105">
                              <a:s r="104">
                                 <a:s>HIC</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="105">
                                 <a:s>&quot;By Age Stratifier 2&quot;</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
+ </a:s>
                        <a:s r="107">
                           <a:s>':'</a:s>
                        </a:s>
                     </a:s>
                     <a:s> + </a:s>
                     <a:s r="110">
                        <a:s r="109">
                           <a:s>HIC</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="110">
                           <a:s>&quot;By Geographic Region Stratifier&quot;</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s>
+ </a:s>
                  <a:s r="115">
                     <a:s>Combine(</a:s>
                     <a:s r="113">
                        <a:s r="112">
                           <a:s>HIC</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="113">
                           <a:s>patientGroups</a:s>
                        </a:s>
                     </a:s>
                     <a:s>, </a:s>
                     <a:s r="114">
                        <a:s>':'</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="116" locator="153:2-157:33" xsi:type="Concatenate">
            <operand localId="111" locator="153:2-156:45" xsi:type="Concatenate">
               <operand localId="108" locator="153:2-156:5" xsi:type="Concatenate">
                  <operand localId="106" locator="153:2-155:35" xsi:type="Concatenate">
                     <operand localId="103" locator="153:2-155:7" xsi:type="Concatenate">
                        <operand localId="101" locator="153:2-154:52" xsi:type="Concatenate">
                           <operand localId="97" locator="153:2-154:6" xsi:type="Concatenate">
                              <operand localId="95" locator="153:2-153:47" path="code" xsi:type="Property">
                                 <source localId="94" locator="153:2-153:42" name="By Administrative Gender Stratifier" libraryName="HIC" xsi:type="ExpressionRef"/>
                              </operand>
                              <operand localId="96" locator="154:4-154:6" valueType="t:String" value=":" xsi:type="Literal"/>
                           </operand>
                           <operand localId="100" locator="154:10-154:52" path="code" xsi:type="Property">
                              <source localId="99" locator="154:10-154:47" name="HIV status of partner or contact" libraryName="HIC" xsi:type="ExpressionRef"/>
                           </operand>
                        </operand>
                        <operand localId="102" locator="155:5-155:7" valueType="t:String" value=":" xsi:type="Literal"/>
                     </operand>
                     <operand localId="105" locator="155:11-155:35" name="By Age Stratifier 2" libraryName="HIC" xsi:type="ExpressionRef"/>
                  </operand>
                  <operand localId="107" locator="156:3-156:5" valueType="t:String" value=":" xsi:type="Literal"/>
               </operand>
               <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                  <operand localId="110" locator="156:9-156:45" name="By Geographic Region Stratifier" libraryName="HIC" xsi:type="ExpressionRef"/>
               </operand>
            </operand>
            <operand localId="115" locator="157:3-157:33" xsi:type="Combine">
               <source localId="113" locator="157:11-157:27" name="patientGroups" libraryName="HIC" xsi:type="ExpressionRef"/>
               <separator localId="114" locator="157:30-157:32" valueType="t:String" value=":" xsi:type="Literal"/>
            </operand>
         </expression>
      </def>
   </statements>
</library>
