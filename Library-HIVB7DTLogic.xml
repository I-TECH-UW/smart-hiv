<?xml version="1.0" encoding="UTF-8"?>

<Library xmlns="http://hl7.org/fhir">
  <id value="HIVB7DTLogic"/>
  <meta>
    <profile value="http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-shareablelibrary"/>
    <profile value="http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-publishablelibrary"/>
    <profile value="http://hl7.org/fhir/uv/cql/StructureDefinition/cql-library"/>
    <profile value="http://hl7.org/fhir/uv/cql/StructureDefinition/cql-module"/>
  </meta>
  <text>
    <status value="extensions"/><div xmlns="http://www.w3.org/1999/xhtml">
<div>
    <table class="grid dict">
        
        
        <tr>
            <th scope="row"><b>Title: </b></th>
            <td style="padding-left: 4px;">HIV.B7.DT Logic</td>
        </tr>
        

        
        
        <tr>
            <th scope="row"><b>Id: </b></th>
            <td style="padding-left: 4px;">HIVB7DTLogic</td>
        </tr>
        

        
        
        <tr>
            <th scope="row"><b>Version: </b></th>
            <td style="padding-left: 4px;">0.4.1</td>
        </tr>
        

        
        <tr>
            <th scope="row"><b>Url: </b></th>
            <td style="padding-left: 4px;"><a href="Library-HIVB7DTLogic.html">HIV.B7.DT Logic</a></td>
        </tr>
        

        

        

        
        <tr>
            <th scope="row"><b>Status: </b></th>
            <td style="padding-left: 4px;">draft</td>
        </tr>
        

        
        <tr>
            <th scope="row"><b>Experimental: </b></th>
            <td style="padding-left: 4px;">true</td>
        </tr>
        

        
        <tr>
            <th scope="row"><b>Type: </b></th>
            <td style="padding-left: 4px;">
                
                    
                        
                        <p style="margin-bottom: 5px;">
                            <b>system: </b> <span><a href="http://terminology.hl7.org/6.0.2/CodeSystem-library-type.html">http://terminology.hl7.org/CodeSystem/library-type</a></span>
                        </p>
                        
                        
                        <p style="margin-bottom: 5px;">
                            <b>code: </b> <span>logic-library</span>
                        </p>
                        
                        
                    
                
                
            </td>
        </tr>
        

        

        
        <tr>
            <th scope="row"><b>Date: </b></th>
            <td style="padding-left: 4px;">2025-02-01 06:48:33+0000</td>
        </tr>
        

        
        <tr>
            <th scope="row"><b>Publisher: </b></th>
            <td style="padding-left: 4px;">WHO</td>
        </tr>
        

        
        <tr>
            <th scope="row"><b>Description: </b></th>
            <td style="padding-left: 4px;"><div><p>Description not yet available for HIV.B7.DT Logic.</p>
</div></td>
        </tr>
        

        

        

        

        

        

        

        

        

        

        

        

        

        

        
        
        <tr>
          <td colspan="2">
            <table>
              <tr><th><a id="cql-content"><b>Content: </b></a> text/cql</th></tr>
              <tr><td><pre><code class="language-cql">/**
Library: HIV.B7.DT Logic

@DecisionID: HIV.B7.DT
@BusinessRule: WHO standard testing strategy for HIV-1 diagnosis (among people ≥18 months of age)
@Trigger: HIV.B7 Test for HIV using testing algorithm, HIV.C4 Test for HIV using testing algorithm, HIV.D.11 Retest using HIV strategy
@Description: WHO standard testing strategy for HIV-1 diagnosis (among people ≥18 months of age)

Data Concepts:

*/

library HIVB7DTLogic

using FHIR version '4.0.1'

include HIVCommon version '0.0.1' called HIC
include HIVConcepts called Concepts
include HIVEncounterElements called Elements
include FHIRHelpers version '4.0.1'

include WHOCommon called WCom
  
context Patient

/*
 @output: &quot;Report as HIV-negative&quot;
 */
define &quot;Report as HIV-negative&quot;:
  case 
  when &quot;Assay 1&quot; and &quot;Non-reactive result&quot;
    then true
  else null
  end

/*
 Supporting Logic
 */
define &quot;Assay 1&quot;:
  exists(&quot;Assay 1 result&quot;) and not(exists(&quot;Assay 2 result&quot;))

define &quot;Assay 2&quot;:
  exists(&quot;Assay 2 result&quot;) and not(exists(&quot;Assay 3 result&quot;))

define &quot;Assay 3&quot;:
  exists(&quot;Assay 3 result&quot;)

define &quot;Assay 1 result&quot;:
  Elements.&quot;Test result of HIV assay 1 B.DE94&quot;

define &quot;Assay 2 result&quot;:
  Elements.&quot;Test result of HIV assay 2 B.DE98&quot;

define &quot;Assay 3 result&quot;:
  Elements.&quot;Test result of HIV assay 3 B.DE102&quot;

define &quot;Non-reactive result&quot;:
  false
</code></pre></td></tr>
            </table>
          </td>
        </tr>
        
        
        
    </table>
</div>
</div>
  </text>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-knowledgeCapability">
    <valueCode value="computable"/>
  </extension>
  <url value="http://smart.who.int/hiv/Library/HIVB7DTLogic"/>
  <version value="0.4.1"/>
  <name value="HIVB7DTLogic"/>
  <title value="HIV.B7.DT Logic"/>
  <status value="draft"/>
  <experimental value="true"/>
  <type>
    <coding>
      <system value="http://terminology.hl7.org/CodeSystem/library-type"/>
      <code value="logic-library"/>
    </coding>
  </type>
  <date value="2025-02-01T06:48:33+00:00"/>
  <publisher value="WHO"/>
  <contact>
    <name value="WHO"/>
    <telecom>
      <system value="url"/>
      <value value="http://who.int"/>
    </telecom>
  </contact>
  <description value="Description not yet available for HIV.B7.DT Logic."/>
  <content>
    <contentType value="text/cql"/>
    <data value="LyoqCkxpYnJhcnk6IEhJVi5CNy5EVCBMb2dpYwoKQERlY2lzaW9uSUQ6IEhJVi5CNy5EVApAQnVzaW5lc3NSdWxlOiBXSE8gc3RhbmRhcmQgdGVzdGluZyBzdHJhdGVneSBmb3IgSElWLTEgZGlhZ25vc2lzIChhbW9uZyBwZW9wbGUg4omlMTggbW9udGhzIG9mIGFnZSkKQFRyaWdnZXI6IEhJVi5CNyBUZXN0IGZvciBISVYgdXNpbmcgdGVzdGluZyBhbGdvcml0aG0sIEhJVi5DNCBUZXN0IGZvciBISVYgdXNpbmcgdGVzdGluZyBhbGdvcml0aG0sIEhJVi5ELjExIFJldGVzdCB1c2luZyBISVYgc3RyYXRlZ3kKQERlc2NyaXB0aW9uOiBXSE8gc3RhbmRhcmQgdGVzdGluZyBzdHJhdGVneSBmb3IgSElWLTEgZGlhZ25vc2lzIChhbW9uZyBwZW9wbGUg4omlMTggbW9udGhzIG9mIGFnZSkKCkRhdGEgQ29uY2VwdHM6CgoqLwoKbGlicmFyeSBISVZCN0RUTG9naWMKCnVzaW5nIEZISVIgdmVyc2lvbiAnNC4wLjEnCgppbmNsdWRlIEhJVkNvbW1vbiB2ZXJzaW9uICcwLjAuMScgY2FsbGVkIEhJQwppbmNsdWRlIEhJVkNvbmNlcHRzIGNhbGxlZCBDb25jZXB0cwppbmNsdWRlIEhJVkVuY291bnRlckVsZW1lbnRzIGNhbGxlZCBFbGVtZW50cwppbmNsdWRlIEZISVJIZWxwZXJzIHZlcnNpb24gJzQuMC4xJwoKaW5jbHVkZSBXSE9Db21tb24gY2FsbGVkIFdDb20KICAKY29udGV4dCBQYXRpZW50CgovKgogQG91dHB1dDogIlJlcG9ydCBhcyBISVYtbmVnYXRpdmUiCiAqLwpkZWZpbmUgIlJlcG9ydCBhcyBISVYtbmVnYXRpdmUiOgogIGNhc2UgCiAgd2hlbiAiQXNzYXkgMSIgYW5kICJOb24tcmVhY3RpdmUgcmVzdWx0IgogICAgdGhlbiB0cnVlCiAgZWxzZSBudWxsCiAgZW5kCgovKgogU3VwcG9ydGluZyBMb2dpYwogKi8KZGVmaW5lICJBc3NheSAxIjoKICBleGlzdHMoIkFzc2F5IDEgcmVzdWx0IikgYW5kIG5vdChleGlzdHMoIkFzc2F5IDIgcmVzdWx0IikpCgpkZWZpbmUgIkFzc2F5IDIiOgogIGV4aXN0cygiQXNzYXkgMiByZXN1bHQiKSBhbmQgbm90KGV4aXN0cygiQXNzYXkgMyByZXN1bHQiKSkKCmRlZmluZSAiQXNzYXkgMyI6CiAgZXhpc3RzKCJBc3NheSAzIHJlc3VsdCIpCgpkZWZpbmUgIkFzc2F5IDEgcmVzdWx0IjoKICBFbGVtZW50cy4iVGVzdCByZXN1bHQgb2YgSElWIGFzc2F5IDEgQi5ERTk0IgoKZGVmaW5lICJBc3NheSAyIHJlc3VsdCI6CiAgRWxlbWVudHMuIlRlc3QgcmVzdWx0IG9mIEhJViBhc3NheSAyIEIuREU5OCIKCmRlZmluZSAiQXNzYXkgMyByZXN1bHQiOgogIEVsZW1lbnRzLiJUZXN0IHJlc3VsdCBvZiBISVYgYXNzYXkgMyBCLkRFMTAyIgoKZGVmaW5lICJOb24tcmVhY3RpdmUgcmVzdWx0IjoKICBmYWxzZQo="/>
  </content>
</Library>